amqp_broker/
â”œâ”€â”€ broker.py                     # ğŸšª Entry point + dispatcher
â”œâ”€â”€ config.py                     # âš™ï¸ Settings and runtime flags
â”œâ”€â”€ protocol/                     
â”‚   â”œâ”€â”€ __init__.py               
â”‚   â”œâ”€â”€ amqp_0_9_1.py             # full channel and frame state machine(FCFSM)
â”‚   â”œâ”€â”€ amqp_1_0.py               # AMQP proto header, parse frame types and dispatch based on simp. prf
â”‚   â”œâ”€â”€ mqtt.py                   #
â”‚   â”œâ”€â”€ stomp_plugin.py           #
â”‚   â”œâ”€â”€ websocket.py              #
â”‚   â””â”€â”€ framing.py                # handles binary framing, backbone of AMQP 0-9-1 and 1.0
â”œâ”€â”€ core/                         
â”‚   â”œâ”€â”€ __init__.py               
â”‚   â”œâ”€â”€ exchange.py               #
â”‚   â”œâ”€â”€ queue.py                  #
â”‚   â”œâ”€â”€ stream.py                 #
â”‚   â”œâ”€â”€ routing.py                #
â”‚   â”œâ”€â”€ delivery.py               #
â”‚   â””â”€â”€ scheduler.py              #
â”œâ”€â”€ storage/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ snapshot.py
â”‚   â”œâ”€â”€ persistence.py
â”‚   â””â”€â”€ stream_index.py
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ users.py
â”‚   â””â”€â”€ vhosts.py
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ http_api.py
â”‚   â””â”€â”€ websocket_api.py
â”œâ”€â”€ util/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ threading_utils.py
â”‚   â””â”€â”€ logging.py
â””â”€â”€ plugins/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ stomp_proxy.py

---chapter 12---
core/
â”œâ”€â”€ queue.py          ğŸ†• TTL, prefetch, dead-lettering (updated)
â”œâ”€â”€ delivery.py       ğŸ†• Confirm tracking (in-flight messages) (new file)
storage/
â””â”€â”€ snapshot.py       (for future queue persistence) (new file)
--ch13--
config.py                        Add TLS/mTLS flags
util/security.py                 TLS context manager + JWT checker
broker.py                        Wire TLS + token parsing into listeners
api/http_api.py                  Enforce JWT on HTTP endpoints
